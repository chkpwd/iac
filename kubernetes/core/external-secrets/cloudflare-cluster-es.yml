---
# yaml-language-server: $schema=https://kube-schemas.pages.dev/external-secrets.io/clusterexternalsecret_v1beta1.json
apiVersion: external-secrets.io/v1beta1
kind: ClusterExternalSecret
metadata:
  name: cloudflare
spec:
  externalSecretName: cloudflare
  namespaceSelectors:
    - matchExpressions:
      - { key:  kubernetes.io/metadata.name, operator: In, values: [tools, security] }
  refreshTime: 15m
  externalSecretSpec:
    secretStoreRef:
      name: bitwarden-secrets-manager
      kind: ClusterSecretStore
    refreshInterval: "1h"
    target:
      name: cloudflare
      template:
        data:
          CLOUDFLARE_ACCOUNT_ID: "{{ .account_id }}"
    dataFrom:
      - extract:
          key: cloudflare-dns-secrets
